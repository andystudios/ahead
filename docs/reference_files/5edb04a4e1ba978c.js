
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="df34fa57-6084-523d-9f9c-a7cfd9bafd3b")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,924499,15243,e=>{"use strict";e.s(["HealthReportProvider",()=>x,"useHealthReport",()=>p],924499);var t=e.i(843476),a=e.i(951984),i=e.i(995446),l=e.i(676029),s=e.i(479393),n=e.i(271645),r=e.i(764085);e.s(["HealthReportParamViewProvider",()=>c,"useHealthReportParamView",()=>u],15243);var o=e.i(173519);let d=(0,n.createContext)({view:"report",filter:"all",setFilter:()=>{},setView:()=>{}});function c(e){let{children:a}=e,[i,l]=(0,o.useSearchParamSyncedState)("filter","all"),[s,r]=(0,o.useSearchParamSyncedState)("view","");return(0,n.useEffect)(()=>{if(s){var e;null==(e=document.querySelector("[data-scroll-container]"))||e.scrollTo({top:0,behavior:"smooth"})}},[s]),(0,t.jsx)(d.Provider,{value:{view:s||null,filter:i,setFilter:e=>l(e),setView:e=>r(e)},children:a})}function u(){return(0,n.useContext)(d)}let m=(0,n.createContext)({}),x=e=>{var o;let{children:d,reportKey:c,defaultRawData:x}=e,{i18n:p}=(0,l.useT)(),h=(0,a.useUser)(),f=null==(o=h.user)?void 0:o.uid,{filter:v}=u(),g=(0,n.useMemo)(()=>x||h.loading?(0,r.getEmptyReportObservables)(c):(0,r.getReportObservables)(c,f,h.isReadAdmin),[c,f,h.isReadAdmin,h.loading,x]),b=(0,i.useObsWithError)(g.reportObs,[]),j=(0,i.useObs)(g.userReportsObs,[f]),y=(0,i.useObs)(g.hydratedDataPointsObs,[c]),w=(0,i.useObsWithError)(g.sourceFilesObs,[c]),N=(0,i.useObsWithError)(g.doctorObs,[c]),P=(0,i.useObs)(g.notesObs,[c,f]),D=(0,i.useObs)(g.panelsObs,[]),k=(0,i.useObs)(g.organsObs,[]),R=(0,i.useObs)(g.optimisationsObs,[c]),O=(0,i.useObs)(g.followupsObs,[c]),C=(0,i.useObs)(g.optimisationTypesObs,[c]),M=(0,i.useObs)(g.followupTypesObs,[c]),S=(0,i.useObs)(g.availableArticlesObs,[c]),I=(0,i.useObs)(g.referralGuidesObs,[c]),F=(0,i.useObs)(g.bookingObs,[c]),E=(0,i.useObs)(g.clinicsObs,[]),T=(0,i.useObs)(g.productsObs,[]),z=(0,i.useObs)(g.preparationInstructionsObs,[]),A=(0,i.useObs)(g.questionnaireResponsesObs,[c]),L=(0,n.useMemo)(()=>(null==y?void 0:y.reduce((e,t)=>(e[t.uid]=t,e),{}))||{},[y]),q=(0,n.useCallback)(e=>L[e],[L]),B=b.loading||!y||w.loading||N.loading||!D||!k||!P||!R||!O||(0,s.default)(F)||!E||!T||!z||!A||!j,K=b.error||w.error||N.error,H=(0,n.useMemo)(()=>x||(b.value&&y&&w.value&&P&&D&&k?{report:b.value,dataPoints:y,sourceFiles:w.value,notes:P,panels:D,organs:k,reportKey:c,userKey:f,filter:v,isAdmin:h.isReadAdmin,optimisationTypes:C||[],followupTypes:M||[],optimisations:R||[],followups:O||[],referralGuide:I||null,booking:F||null,clinics:E||[],products:T||[],preparationInstructions:z||[],questionnaireResponses:A||[]}:null),[b.value,y,w.value,P,D,k,c,f,v,C,M,R,O,x,h.isReadAdmin,I,F,E,T,z,A]),V=(0,n.useMemo)(()=>H?{...(0,r.processReportData)(H,p)}:null,[H,p]),_=(0,n.useMemo)(()=>V?{data:{...V,availableArticles:S||[],doctor:N.value||(null==x?void 0:x.doctor)||null,loadingReport:B,unauthorized:!x&&!!K,booking:F||null,getDataPointById:q,userReports:j||[]}}:{data:{report:b.value,dataPointsForThisReport:{grouped:{},all:[]},doctor:null,allDataPoints:[],sourceFiles:[],reportSummary:null,allHealthNotes:[],allOptimisations:[],allFollowups:[],optimisationsForCurrentReport:[],followupsForCurrentReport:[],loadingReport:B,unauthorized:!!K,getOrganInfo:()=>void 0,effectiveReportDate:null,actionSummary:null,availableArticles:[],getFollowupById:()=>void 0,getOptimisationById:()=>void 0,getDataPointById:()=>void 0,referralGuide:null,panelsInReport:[],booking:null,clinics:[],products:[],preparationInstructions:[],questionnaireResponses:[],userReports:[]}},[x,V,N.value,b.value,B,K,S,F,q,j]);return(0,t.jsx)(m.Provider,{value:_,children:d})},p=()=>{let e=(0,n.useContext)(m);if(!e||!e.data)throw Error("useHealthReport must be used within a HealthReportProvider");return e.data}},257953,e=>{"use strict";e.s(["DpExpandedStateProvider",()=>s,"useDpExpandedState",()=>n]);var t=e.i(843476),a=e.i(618566),i=e.i(271645);let l=(0,i.createContext)({expandedState:{},setExpanded:()=>{},toggleExpanded:()=>{},isExpanded:()=>!1,setAllExpanded:()=>{}});function s(e){let{children:s,dataPointIds:n=[]}=e,r=(0,a.useSearchParams)(),[o,d]=(0,i.useState)({});(0,i.useEffect)(()=>{if("true"===r.get("autoExpandDps")&&n.length>0){let e={};n.forEach(t=>{e[t]=!0}),d(e)}},[r,n]);let c=(0,i.useCallback)((e,t)=>{d(a=>({...a,[e]:t}))},[]),u=(0,i.useCallback)(e=>{d(t=>({...t,[e]:!t[e]}))},[]),m=(0,i.useCallback)(e=>{var t;return null!=(t=o[e])&&t},[o]),x=(0,i.useCallback)((e,t)=>{let a={};(t||n).forEach(t=>{a[t]=e}),d(a)},[n]);return(0,t.jsx)(l.Provider,{value:{expandedState:o,setExpanded:c,toggleExpanded:u,isExpanded:m,setAllExpanded:x},children:s})}function n(){return(0,i.useContext)(l)}},86966,(e,t,a)=>{var i=e.r(641015),l=e.r(580957),s=e.r(653336);t.exports=function(e){return e&&e.length?i(e,s,l):void 0}},298128,(e,t,a)=>{t.exports=function(e,t){return e<t}},37544,(e,t,a)=>{var i=e.r(641015),l=e.r(298128),s=e.r(653336);t.exports=function(e){return e&&e.length?i(e,s,l):void 0}},109881,481175,829939,e=>{"use strict";e.s(["DataPointDisplay",()=>ep,"DataPointsDisplay",()=>ex],109881);var t=e.i(843476),a=e.i(165981),i=e.i(831195),l=e.i(257953),s=e.i(924499),n=e.i(459217),r=e.i(735321),o=e.i(834907),d=e.i(647163),c=e.i(945919),u=e.i(774010),m=e.i(664659),x=e.i(271645),p=e.i(59377),h=e.i(629873),f=e.i(86966),v=e.i(37544);e.i(785269);var g=e.i(322831),b=e.i(948695);let j={[a.OutOfRangeIndication.Optimal]:"bg-linear-to-r from-white to-acai-300",[a.OutOfRangeIndication.Good]:"bg-linear-to-r from-white to-deep-green-300",[a.OutOfRangeIndication.Intermediate]:"bg-linear-to-r from-white to-rust-300",[a.OutOfRangeIndication.Bad]:"bg-linear-to-r from-white to-aubergine-300"},y=e=>{let{displayRangeMin:a,displayRangeMax:i,portion:l,bgClassName:s}=e,n=i-a,{lowerBound:r,upperBound:o,label:d}=l,c=50,u=50;return(0,h.default)(r)||(0,h.default)(o)?(0,h.default)(r)?(0,h.default)(o)||(c=(i-o)/n*100,u=100):(c=0,u=(i-r)/n*100):(c=(i-o)/n*100,u=(i-r)/n*100),(0,t.jsx)("div",{className:"absolute w-full min-w-0 shrink-0 text-xs text-gray-600 ".concat(s," rounded-lg border-white"),style:{top:"".concat(c,"%"),height:"".concat(u-c,"%")},children:(0,t.jsxs)("div",{className:"flex h-full items-center",children:[d,": ",(e=>{let{lowerBound:t,upperBound:a}=e;return(0,h.default)(t)||(0,h.default)(a)?(0,h.default)(t)?(0,h.default)(a)?"":"< ".concat(a):"> ".concat(t):"".concat(t," - ").concat(a)})(l)]})})};function w(e){var a,i,l,s;let{historicalDatapoints:n}=e,{i18n:u}=(0,g.useTranslation)();if(0===n.length)return null;let m=u.language,x=n.map(e=>{var t;return null==(t=e.dataPoint.biomarkerData)?void 0:t.value}).filter(e=>void 0!==e);if(0===x.length)return null;let h=n[n.length-1],{referenceRangeMin:w,referenceRangeMax:N,visiblePortions:P}=(0,r.getDpRangeState)(h),D=N&&w?N-w:null,k=(0,f.default)(x),R=(0,v.default)(x),O=D?Math.max(N+D/2):null,C=D?Math.min(w-D/2):null,M=null!=(l=null==(a=h.info)?void 0:a.displayRangeMax)?l:O||100,S=null!=(s=null==(i=h.info)?void 0:i.displayRangeMin)?s:C||0,I=Math.max(M,k),F=Math.min(S,R),E=(I-F)*.1,T=I+E,z=F-E,A=T-z,L=n[n.length-1],q="w-12 text-center text-xs shrink-0 py-2";return(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"relative h-40 overflow-hidden rounded-lg",children:[(0,t.jsxs)("div",{className:"relative flex h-full items-end justify-end",children:[(0,t.jsx)("div",{className:"w-44 shrink-0"}),(0,t.jsx)("div",{className:"z-10 flex h-full flex-row-reverse items-end overflow-x-auto",children:[...n].reverse().map(e=>{var a,i;let l=null==(a=e.dataPoint.biomarkerData)?void 0:a.value,s=Math.min(Math.max(l||0,z),T);if(!l)return null;let n=(T-s)/A*100,r=e.uid===L.uid,u=(0,o.getDpSortDate)(e),x=new Date(u),f=new Date,v=u<new Date(f.getFullYear()-1,f.getMonth(),f.getDate()).getTime()?(0,c.formatDate)(x,"MMM ''yy",{locale:(0,b.getLanguageLocale)(m)}):(0,c.formatDate)(x,"MMM d",{locale:(0,b.getLanguageLocale)(m)}),g=(0,t.jsx)("div",{className:(0,d.cn)(q,{"font-medium":r}),children:v},e.uid);return(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"relative flex min-h-0 w-12 shrink-0 grow items-end justify-center",children:[r&&(0,t.jsx)("div",{className:"border-dashed-line absolute top-0 bottom-0 left-1/2 w-px -translate-x-1/2 border-l-2 border-dashed opacity-20"}),(0,t.jsxs)(p.Popover,{children:[(0,t.jsx)(p.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)("div",{className:"absolute z-10 -translate-y-1/2 cursor-pointer",style:{top:"".concat(n,"%")},children:[(0,t.jsx)("div",{className:"absolute -inset-2"}),(0,t.jsx)("div",{className:"relative h-3 w-3 rounded-full border-4 border-black bg-white"})]})}),(0,t.jsxs)(p.PopoverContent,{className:"relative w-auto bg-white p-2 shadow-lg",side:"top",align:"center",sideOffset:8,children:[(0,t.jsxs)("div",{className:"text-sm font-medium",children:[l," ",null==(i=h.info)?void 0:i.metric]}),(0,t.jsx)("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2",children:(0,t.jsx)("div",{className:"h-2 w-2 rotate-45 border-r border-b bg-white"})})]})]})]}),g]},e.uid)})})]}),(0,t.jsxs)("div",{className:"absolute inset-x-0 top-0 flex h-full flex-col",children:[(0,t.jsx)("div",{className:"relative min-h-0 shrink-0 grow",children:P.map((e,a)=>(0,t.jsx)(y,{displayRangeMin:z,displayRangeMax:T,portion:e,bgClassName:e.isActive?j[e.indication]:void 0},a))}),(0,t.jsx)("div",{className:q,children:" "})]})]})})}var N=e.i(908098),P=e.i(655900),D=e.i(25887);function k(e){let{question:a,answer:i}=e,[l,s]=(0,x.useState)(!1),{log:n}=(0,D.useA)("report");return(0,t.jsxs)("div",{className:"bg-background rounded-lg",children:[(0,t.jsxs)("button",{onClick:()=>{l||n("data_point_question_expanded",{question:a}),s(!l)},className:"flex w-full items-center justify-between px-4 py-3 text-left",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:a}),l?(0,t.jsx)(P.ChevronUp,{className:"h-4 w-4 text-gray-400"}):(0,t.jsx)(m.ChevronDown,{className:"h-4 w-4 text-gray-400"})]}),l&&(0,t.jsx)("div",{className:"px-4 pb-3",children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:i})})]})}var R=e.i(676029),O=e.i(371532),C=e.i(95482),M=e.i(717014);e.s(["useLogEvent",()=>F,"useLogEventOnMount",()=>I],481175);var S=e.i(479393);let I=(e,t,a,i)=>{let{log:l}=(0,D.useAnalytics)(e),s=(0,x.useRef)(!1);(0,x.useEffect)(()=>{((0,S.default)(i)?!s.current:i)&&(l(t,a),s.current=!0)},[i])},F=(e,t,a,i)=>{let{log:l}=(0,D.useAnalytics)(e);(0,x.useEffect)(()=>{i&&l(t,a)},[i])};var E=e.i(717038),T=e.i(995446),z=e.i(326999),A=e.i(37727),L=e.i(414934),q=e.i(460793);let B={[a.DataPointSeverity.Normal]:"Observation",[a.DataPointSeverity.Minor]:"Minor Finding",[a.DataPointSeverity.Intermediate]:"Intermediate Finding",[a.DataPointSeverity.Major]:"Major Finding",[a.DataPointSeverity.Serious]:"Serious Finding"};var K=e.i(230698);let H={[a.DataPointSeverity.Normal]:{title:"No clinical significance",details:"No follow-up or action required"},[a.DataPointSeverity.Minor]:{title:"Clinically insignificant",details:"May warrant consideration for preventive or optimization strategies"},[a.DataPointSeverity.Intermediate]:{title:"Clinical significance present",details:"Clinical follow-up or preventive/optimization action recommended"},[a.DataPointSeverity.Major]:{title:"Clinically significant",details:"Follow-up and clinical action required"},[a.DataPointSeverity.Serious]:{title:"Clinically urgent",details:"Immediate clinical action required"}},V=e=>{let{severity:a}=e,{t:i}=(0,R.useT)(),l=(0,q.default)(H,e=>({title:i(e.title),details:i(e.details)}))[a];return(0,t.jsxs)("div",{className:"flex flex-col gap-1 text-white",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:l.title}),(0,t.jsx)("div",{className:"text-[13px]",children:l.details})]})};var _=e.i(310445);let W={[a.DataPointSeverity.Normal]:1,[a.DataPointSeverity.Minor]:2,[a.DataPointSeverity.Intermediate]:3,[a.DataPointSeverity.Major]:4,[a.DataPointSeverity.Serious]:5},G=e=>{let{severity:i}=e,l=a.DataPointSeverity.Normal,s=i||l,n=W[s],r=K.adminSeverityColors[s];return(0,t.jsxs)(p.Popover,{children:[(0,t.jsx)(p.PopoverTrigger,{asChild:!0,onClick:e=>{e.stopPropagation()},children:(0,t.jsxs)("div",{className:"flex shrink-0 grow-0 cursor-pointer items-center gap-1 transition-opacity hover:opacity-80",children:[(0,t.jsx)(p.PopoverAnchor,{children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,t.jsx)("div",{className:(0,d.cn)("h-2 w-2 rounded-full",a<n?r:"bg-gray-200")},a))," "]})}),(0,t.jsx)("div",{className:"text-sm",children:(e=>{let{t}=(0,R.useT)(),i=(0,q.default)(B,e=>t(e));return i[e]||i[a.DataPointSeverity.Normal]})(s)})]})}),(0,t.jsxs)(p.PopoverContent,{side:"bottom",align:"start",className:"from-deep-green-500 to-deep-green-600 rounded-xl border-none bg-gradient-to-r p-0",collisionPadding:20,children:[(0,t.jsx)(p.PopoverArrow,{className:"text-deep-green-500 z-100 border-none fill-current",width:12,height:6,offset:24,style:{transform:"translateY(-1px)"}}),(0,t.jsxs)("div",{className:"relative p-4",children:[(0,t.jsx)("div",{className:"absolute top-2 right-2",children:(0,t.jsx)(p.PopoverClose,{asChild:!0,children:(0,t.jsx)(_.CloseIcon,{className:"cursor-pointer bg-white/20 text-white transition-colors hover:bg-white/30"})})}),(0,t.jsx)(V,{severity:s})]})]})]})};function U(e){let{dpInfo:a}=e;return(0,t.jsx)("div",{className:"p-6 pb-4",children:"quant"===a.type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-white/90",children:a.biomarkerName}),(0,t.jsxs)("div",{className:"mt-1 flex items-baseline gap-1",children:[(0,t.jsx)("span",{className:"text-4xl font-semibold",children:a.value}),(0,t.jsx)("span",{className:"text-xl text-white/60 uppercase",children:a.unit})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-white/90",children:a.title}),a.severity&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(G,{severity:a.severity})})]})})}function Y(e){var a,i,l,s,n,r;let{imageReference:o}=e,d=(0,T.useObs)((0,E.docObs)("sourceFile",o.sourceFileKey),[o.sourceFileKey]),c=(null==d||null==(i=d.fileLocation)||null==(a=i.originalFileExtension)?void 0:a.match(/nii|nii.gz/i))||(null==d||null==(s=d.fileLocation)||null==(l=s.originalFileName)?void 0:l.match(/nii|nii.gz/i))||(null==d||null==(r=d.fileLocation)||null==(n=r.path)?void 0:n.match(/nii|nii.gz/i));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex min-h-0 grow flex-col",children:(0,t.jsx)(N.ImageReferenceDisplay,{imageReference:o})}),c?(0,t.jsx)("div",{className:"mt-6 flex w-full justify-center",children:(0,t.jsx)(L.MRINavigationBar,{sourceFileKey:o.sourceFileKey})}):(0,t.jsx)("div",{className:"mt-6"})]})}function X(e){let{imageReference:a,dpInfo:i}=e;return(0,t.jsxs)("div",{className:"relative flex h-full flex-col",children:[(0,t.jsx)(U,{dpInfo:i}),(0,t.jsx)(Y,{imageReference:a})]})}function J(e){var a,i,l,s,n,r;let{isOpen:o,onClose:d,imageReference:c,dpInfo:u}=e,m=(0,T.useObs)((0,E.docObs)("sourceFile",c.sourceFileKey),[c.sourceFileKey]),x=(null==m||null==(i=m.fileLocation)||null==(a=i.originalFileExtension)?void 0:a.match(/nii|nii.gz/i))||(null==m||null==(s=m.fileLocation)||null==(l=s.originalFileName)?void 0:l.match(/nii|nii.gz/i))||(null==m||null==(r=m.fileLocation)||null==(n=r.path)?void 0:n.match(/nii|nii.gz/i));return F("report","image_viewer_opened",{imageReferenceKey:c.sourceFileKey,isMri:!!x},o),(0,t.jsx)(z.Root,{open:o,onOpenChange:d,children:(0,t.jsxs)(z.Portal,{children:[(0,t.jsx)(z.DialogTitle,{className:"sr-only",children:"quant"===u.type?u.biomarkerName:u.title}),(0,t.jsx)(z.Overlay,{className:"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80 backdrop-blur-xs"}),(0,t.jsxs)(z.Content,{className:"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed top-[50%] left-[50%] z-50 h-[600px] max-h-[90vh] w-[860px] max-w-[90vw] translate-x-[-50%] translate-y-[-50%] rounded-2xl bg-black text-white shadow-xl duration-200",children:[(0,t.jsxs)(z.Close,{className:"absolute top-4 right-4 z-10 cursor-pointer rounded-full bg-white/10 p-2 backdrop-blur-sm transition-colors hover:bg-white/20 focus:outline-hidden",children:[(0,t.jsx)(A.X,{className:"h-4 w-4 text-white"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,t.jsx)(C.ErrorBoundary,{fallback:(0,t.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,t.jsx)("div",{className:"text-white/60",children:"Failed to load viewer"})}),children:(0,t.jsx)(M.MRIControlsProvider,{children:(0,t.jsx)(X,{imageReference:c,dpInfo:u})})})]})]})})}var Q=e.i(794763);function Z(e){let{biomarkerName:a,description:i,whyItMatters:l}=e,{t:s}=(0,R.useT)();return(0,t.jsxs)("div",{className:"space-y-2",children:[i&&(0,t.jsx)(k,{question:s("What is {{biomarkerName}}?",{biomarkerName:a}),answer:i}),l&&(0,t.jsx)(k,{question:s("Why does {{biomarkerName}} matter?",{biomarkerName:a}),answer:l})]})}function $(e){var a,i;let{imageReferences:l,dp:s}=e,[n,r]=(0,x.useState)(!1),d=(0,Q.useDpDisplayFields)(s);if(!l||0===l.length)return null;let u=l[0],m=(null==(a=s.info)?void 0:a.referenceImageLabel)||"MRI: ".concat(null==(i=s.info)?void 0:i.name),p=(0,c.formatDate)((0,o.getDpSortDate)(s),"MMM d, yyyy");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex cursor-pointer items-center justify-between",onClick:()=>r(!0),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{className:"relative flex h-16 w-16 flex-col overflow-hidden rounded-lg border transition-opacity hover:opacity-80",children:(0,t.jsx)(N.ImageReferenceThumbnail,{imageReference:u})}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:m}),(0,t.jsx)("div",{className:"text-xs",children:p})]})]}),(0,t.jsx)("button",{className:"rounded-lg p-2 transition-colors hover:bg-gray-100",children:(0,t.jsx)(O.MagnifyingGlassIcon,{className:"h-6 w-6 text-black"})})]}),(0,t.jsx)(J,{isOpen:n,onClose:()=>r(!1),imageReference:u,dpInfo:{type:"quant",biomarkerName:d.title,value:d.value||"",unit:d.unit}})]})}function ee(e){var a;let{dataPoint:i}=e,l=i.info,{isPdfRender:s}=(0,x.useContext)(n.IsPdfRenderContext),r=ea(null==(a=i.dataPoint.biomarkerData)?void 0:a.biomarkerId);return l?(0,t.jsxs)("div",{className:"flex min-h-0 grow flex-col gap-6",children:[(0,t.jsx)(w,{historicalDatapoints:r}),!s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Z,{biomarkerName:l.name,description:l.description||void 0,whyItMatters:l.whyItMatters||void 0}),(0,t.jsx)($,{imageReferences:i.dataPoint.imageReferences,dp:i})]})]}):null}var et=e.i(494763);let ea=e=>{let{allDataPoints:t,report:a}=(0,s.useHealthReport)(),l=t.filter(t=>{var a;return(null==(a=t.dataPoint.biomarkerData)?void 0:a.biomarkerId)===e}),n=l.find(e=>{var t;return null==(t=e.reportKeys)?void 0:t.includes(a.uid)}),r=(0,u.default)(l,e=>(0,c.formatDate)((0,o.getDpSortDate)(e),"yyyy-MM-dd")),d=n?(0,o.getDpSortDate)(n):0;return(0,i.default)(r,e=>(0,o.getDpSortDate)(e)).filter(e=>(0,o.getDpSortDate)(e)<=d)},ei=e=>{let{text:a,className:i}=e;return(0,t.jsx)("span",{className:(0,d.cn)("truncate rounded-full px-2 py-1 text-xs text-nowrap print:text-black",i),role:"status",children:a})},el=e=>{let{dataPoint:a}=e,i=(0,r.getDpRangeState)(a),l=i.overallIndication,s=(0,et.getIndicationColorClasses)(l);return(0,t.jsx)(ei,{text:i.activePortionLabel,className:"".concat(s.text," ").concat(s.bg," ").concat(s.printBg)})};function es(e){let{dataPoint:a}=e,{isExpanded:i,toggleExpanded:s}=(0,l.useDpExpandedState)(),o=a.info,c=i(a.uid),{isPdfRender:u}=(0,x.useContext)(n.IsPdfRenderContext),p=(0,Q.useDpDisplayFields)(a),{t:h}=(0,R.useT)(),f=(0,Q.useDpDisplayFields)(a),{log:v}=(0,D.useA)("report");if(!o)return null;let g=(0,t.jsxs)("div",{className:"text-3xl font-semibold",children:[p.value," ",p.uppercase.unit&&(0,t.jsx)("span",{className:"font-mono text-xs font-normal",children:p.uppercase.unit})]}),b=(0,r.getDpRangeState)(a);return(0,t.jsxs)("div",{role:"region","aria-label":f.title||"Biomarker result",children:[(0,t.jsxs)("button",{className:"flex w-full flex-col gap-2 text-left",onClick:e=>{if(e.metaKey&&console.log("dataPoint",a),s(a.uid),!c&&o){var t;let e=null==(t=a.dataPoint.biomarkerData)?void 0:t.biomarkerId;v("data_point_expanded",{biomarkerName:o.name,biomarkerId:e?String(e):""})}e.stopPropagation()},"aria-expanded":c,"aria-label":"".concat(f.title,", ").concat(p.value," ").concat(p.uppercase.unit||"",", ").concat(b.activePortionLabel,". ").concat(c?"Collapse":"Expand"," details"),children:[(0,t.jsxs)("div",{className:"flex min-w-0 flex-row items-start justify-between gap-2",children:[(0,t.jsx)("span",{className:"flex-shrink-[100] text-sm font-medium",children:f.title}),(0,t.jsx)("div",{className:"flex flex-row gap-2 overflow-hidden",children:(0,t.jsx)(el,{dataPoint:a})})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2",children:[g,!u&&(0,t.jsxs)("span",{className:"flex items-center gap-1 rounded-md bg-white px-3 py-1.5 text-sm",children:[h(c?"Hide details":"Show details"),(0,t.jsx)(m.ChevronDown,{className:(0,d.cn)("h-4 w-4 transition-transform",c&&"rotate-180"),"aria-hidden":"true"})]})]})]}),c&&(0,t.jsx)(ee,{dataPoint:a})]})}var en=e.i(475254);let er=(0,en.default)("Expand",[["path",{d:"m21 21-6-6m6 6v-4.8m0 4.8h-4.8",key:"1c15vz"}],["path",{d:"M3 16.2V21m0 0h4.8M3 21l6-6",key:"1fsnz2"}],["path",{d:"M21 7.8V3m0 0h-4.8M21 3l-6 6",key:"hawz9i"}],["path",{d:"M3 7.8V3m0 0h4.8M3 3l6 6",key:"u9ee12"}]]),eo=(0,en.default)("Shrink",[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8",key:"17vawe"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6",key:"chjx8e"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6",key:"lav6yq"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3",key:"1pxi2q"}]]);function ed(){let[e,t]=x.useState(void 0);return x.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),a=()=>{t(window.innerWidth<768)};return e.addEventListener("change",a),t(window.innerWidth<768),()=>e.removeEventListener("change",a)},[]),!!e}function ec(e){var a,i,s,r,o,c,u;let{dataPoint:p}=e,{isExpanded:h,toggleExpanded:f}=(0,l.useDpExpandedState)(),v=h(p.uid),[g,b]=(0,x.useState)(!1),{isPdfRender:j}=(0,x.useContext)(n.IsPdfRenderContext),{log:y}=(0,D.useA)("report"),w=ed(),{description:P,title:k}=(0,Q.useDpDisplayFields)(p),R=(null==(a=p.dataPoint.imageReferences)?void 0:a.length)&&!j?(0,t.jsxs)("button",{onClick:e=>{w?v||f(p.uid):(e.stopPropagation(),b(!0))},className:(0,d.cn)("relative flex shrink-0 flex-col self-stretch md:transition-all md:duration-300",v?"h-96 w-full md:h-60 md:w-60":"h-16 w-16"),"aria-label":v&&w?"Close image viewer":"View medical image",children:[(0,t.jsx)("div",{className:"flex min-w-0 grow flex-col overflow-hidden rounded-lg",children:w&&v?(0,t.jsx)(M.MRIControlsProvider,{children:(0,t.jsx)("div",{className:"flex h-full w-full flex-col rounded-lg bg-black text-white",children:(0,t.jsx)(Y,{imageReference:p.dataPoint.imageReferences[0]})})}):(0,t.jsx)(N.ImageReferenceThumbnail,{imageReference:null==(i=p.dataPoint.imageReferences)?void 0:i[0]})}),(0,t.jsx)("div",{className:(0,d.cn)("absolute top-1 right-1 cursor-pointer rounded bg-black/50 p-1 opacity-80 transition-opacity hover:opacity-100 md:block"),onClick:()=>{v&&w&&f(p.uid)},"aria-hidden":"true",children:v&&w?(0,t.jsx)(eo,{className:"h-4 w-4 text-white"}):(0,t.jsx)(er,{className:"h-4 w-4 text-white"})})]}):null,O=(null==(s=p.dataPoint.assessment)?void 0:s.severity)?(0,t.jsx)(G,{severity:null==(r=p.dataPoint.assessment)?void 0:r.severity}):null;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,d.cn)("flex flex-wrap items-start gap-3 transition-all duration-300 md:flex-nowrap",v&&"gap-6"),role:"region","aria-label":k||"Finding","aria-expanded":v,children:[R,(0,t.jsxs)("button",{className:"text-content flex-1 cursor-pointer text-left",onClick:e=>{e.metaKey&&console.log("dataPoint",p),f(p.uid),v||y("data_point_expanded",{biomarkerName:k||"",biomarkerId:""}),e.stopPropagation()},"aria-expanded":v,"aria-label":"".concat(k).concat((null==(o=p.dataPoint.assessment)?void 0:o.severity)?", ".concat(p.dataPoint.assessment.severity):"",". ").concat(v?"Collapse":"Expand"," details"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-base font-medium",children:k}),!j&&(0,t.jsx)("span",{className:"ml-2 flex items-center rounded-md bg-white px-0 py-1.5 text-gray-600",children:(0,t.jsx)(m.ChevronDown,{className:(0,d.cn)("h-4 w-4 transition-transform",v&&"rotate-180"),"aria-hidden":"true"})})]}),O&&(0,t.jsx)("div",{className:"mt-1",children:O}),(v||j)&&P&&(0,t.jsx)("div",{className:"mt-4 border-t pt-4",children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:P})})]})]}),(null==(c=p.dataPoint.imageReferences)?void 0:c[0])&&(0,t.jsx)(J,{isOpen:g,onClose:()=>b(!1),imageReference:p.dataPoint.imageReferences[0],dpInfo:{type:"finding",title:k||"",description:P||void 0,severity:null==(u=p.dataPoint.assessment)?void 0:u.severity}})]})}e.s(["useIsMobile",()=>ed],829939);var eu=e.i(970065);let em=[a.DataPointSource.Blood,a.DataPointSource.ImageBiomarker,a.DataPointSource.MRI,a.DataPointSource.CT],ex=e=>{let{dataPoints:l}=e,s=(0,i.default)(l,[e=>{var t,a;return em.indexOf(null==(a=e.dataPoint)||null==(t=a.tags)?void 0:t.source)},e=>+((0,r.getDpRangeState)(e).overallIndication!==a.OutOfRangeIndication.Bad),e=>{var t;return(null==(t=(0,Q.getDpDisplayFields)(e).title)?void 0:t.toLowerCase())||""}]);return(0,t.jsx)("ul",{className:"flex shrink-0 flex-col gap-2 overflow-visible",role:"list","aria-label":"Biomarker results",children:s.map(e=>(0,t.jsx)("li",{children:(0,t.jsx)(ep,{dataPoint:e})},e.uid))})};function ep(e){var a;let{dataPoint:i}=e,l=!!(null==(a=i.dataPoint.biomarkerData)?void 0:a.biomarkerId),s=i.info,{isPdfRender:r}=(0,x.useContext)(n.IsPdfRenderContext),o=(0,Q.getDpDisplayFields)(i);return(0,t.jsxs)(eu.Card,{className:(0,d.cn)("shadow-glow hover:shadow-glow-strong flex w-full shrink-0 cursor-pointer flex-col bg-white p-4 transition-shadow",{"break-inside-avoid-page overflow-visible border border-gray-200":r}),role:"article","aria-label":o.title||"Biomarker result",children:[l&&s&&(0,t.jsx)(es,{dataPoint:i}),!l&&(0,t.jsx)(ec,{dataPoint:i})]})}}]);

//# sourceMappingURL=a81d39e8d74a98c5.js.map
//# debugId=df34fa57-6084-523d-9f9c-a7cfd9bafd3b
