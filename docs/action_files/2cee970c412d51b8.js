
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3caa4074-8289-5b80-83d6-6b5e5232a068")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,643531,e=>{"use strict";e.s(["Check",()=>t],643531);let t=(0,e.i(475254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},30030,e=>{"use strict";e.s(["createContext",()=>n,"createContextScope",()=>i]);var t=e.i(271645),r=e.i(843476);function n(e,n){let i=t.createContext(n),o=e=>{let{children:n,...o}=e,a=t.useMemo(()=>o,Object.values(o));return(0,r.jsx)(i.Provider,{value:a,children:n})};return o.displayName=e+"Provider",[o,function(r){let o=t.useContext(i);if(o)return o;if(void 0!==n)return n;throw Error("`".concat(r,"` must be used within `").concat(e,"`"))}]}function i(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[],o=()=>{let r=i.map(e=>t.createContext(e));return function(n){let i=(null==n?void 0:n[e])||r;return t.useMemo(()=>({["__scope".concat(e)]:{...n,[e]:i}}),[n,i])}};return o.scopeName=e,[function(n,o){let a=t.createContext(o),u=i.length;i=[...i,o];let l=n=>{var i;let{scope:o,children:l,...s}=n,c=(null==o||null==(i=o[e])?void 0:i[u])||a,d=t.useMemo(()=>s,Object.values(s));return(0,r.jsx)(c.Provider,{value:d,children:l})};return l.displayName=n+"Provider",[l,function(r,i){var l;let s=(null==i||null==(l=i[e])?void 0:l[u])||a,c=t.useContext(s);if(c)return c;if(void 0!==o)return o;throw Error("`".concat(r,"` must be used within `").concat(n,"`"))}]},function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];let i=r[0];if(1===r.length)return i;let o=()=>{let e=r.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(r){let n=e.reduce((e,t)=>{let{useScope:n,scopeName:i}=t,o=n(r)["__scope".concat(i)];return{...e,...o}},{});return t.useMemo(()=>({["__scope".concat(i.scopeName)]:n}),[n])}};return o.scopeName=i.scopeName,o}(o,...n)]}},30207,e=>{"use strict";e.s(["useCallbackRef",()=>r]);var t=e.i(271645);function r(e){let r=t.useRef(e);return t.useEffect(()=>{r.current=e}),t.useMemo(()=>function(){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return null==(e=r.current)?void 0:e.call(r,...n)},[])}},934620,e=>{"use strict";e.s(["useLayoutEffect",()=>n]);var t,r=e.i(271645),n=(null==(t=globalThis)?void 0:t.document)?r.useLayoutEffect:()=>{}},248425,e=>{"use strict";e.s(["Primitive",()=>o,"dispatchDiscreteCustomEvent",()=>a]);var t=e.i(271645),r=e.i(174080),n=e.i(991918),i=e.i(843476),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let o=(0,n.createSlot)("Primitive.".concat(r)),a=t.forwardRef((e,t)=>{let{asChild:n,...a}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(n?o:r,{...a,ref:t})});return a.displayName="Primitive.".concat(r),{...e,[r]:a}},{});function a(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}},991918,820783,e=>{"use strict";e.s(["Slot",()=>u,"createSlot",()=>a,"createSlottable",()=>s],991918);var t=e.i(271645);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{let n=!1,i=t.map(t=>{let i=r(t,e);return n||"function"!=typeof i||(n=!0),i});if(n)return()=>{for(let e=0;e<i.length;e++){let n=i[e];"function"==typeof n?n():r(t[e],null)}}}}function i(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.useCallback(n(...r),r)}e.s(["composeRefs",()=>n,"useComposedRefs",()=>i],820783);var o=e.i(843476);function a(e){let r=function(e){let r=t.forwardRef((e,r)=>{let{children:i,...o}=e;if(t.isValidElement(i)){var a,u,l;let e,s,c=(s=(e=null==(u=Object.getOwnPropertyDescriptor((a=i).props,"ref"))?void 0:u.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(s=(e=null==(l=Object.getOwnPropertyDescriptor(a,"ref"))?void 0:l.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref,d=function(e,t){let r={...t};for(let n in t){let i=e[n],o=t[n];/^on[A-Z]/.test(n)?i&&o?r[n]=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=o(...t);return i(...t),n}:i&&(r[n]=i):"style"===n?r[n]={...i,...o}:"className"===n&&(r[n]=[i,o].filter(Boolean).join(" "))}return{...e,...r}}(o,i.props);return i.type!==t.Fragment&&(d.ref=r?n(r,c):c),t.cloneElement(i,d)}return t.Children.count(i)>1?t.Children.only(null):null});return r.displayName="".concat(e,".SlotClone"),r}(e),i=t.forwardRef((e,n)=>{let{children:i,...a}=e,u=t.Children.toArray(i),l=u.find(c);if(l){let e=l.props.children,i=u.map(r=>r!==l?r:t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null);return(0,o.jsx)(r,{...a,ref:n,children:t.isValidElement(e)?t.cloneElement(e,void 0,i):null})}return(0,o.jsx)(r,{...a,ref:n,children:i})});return i.displayName="".concat(e,".Slot"),i}var u=a("Slot"),l=Symbol("radix.slottable");function s(e){let t=e=>{let{children:t}=e;return(0,o.jsx)(o.Fragment,{children:t})};return t.displayName="".concat(e,".Slottable"),t.__radixId=l,t}function c(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===l}},225913,e=>{"use strict";e.s(["cva",()=>i]);var t=e.i(207670);let r=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,n=t.clsx,i=(e,t)=>i=>{var o;if((null==t?void 0:t.variants)==null)return n(e,null==i?void 0:i.class,null==i?void 0:i.className);let{variants:a,defaultVariants:u}=t,l=Object.keys(a).map(e=>{let t=null==i?void 0:i[e],n=null==u?void 0:u[e];if(null===t)return null;let o=r(t)||r(n);return a[e][o]}),s=i&&Object.entries(i).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return n(e,l,null==t||null==(o=t.compoundVariants)?void 0:o.reduce((e,t)=>{let{class:r,className:n,...i}=t;return Object.entries(i).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...u,...s}[t]):({...u,...s})[t]===r})?[...e,r,n]:e},[]),null==i?void 0:i.class,null==i?void 0:i.className)}},167881,e=>{"use strict";e.s(["Button",()=>u,"buttonVariants",()=>a]);var t=e.i(843476),r=e.i(271645),n=e.i(991918),i=e.i(225913),o=e.i(647163);let a=(0,i.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl transition-colors focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 cursor-pointer",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90 text-white",warning:"bg-warning text-white",ghost:'data-[active="true"]:bg-lightgrey hover:bg-lightgrey hover:text-accent-foreground bg-white rounded-lg border-none',outline:"border border-black bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground cursor-pointer",link:"text-primary underline-offset-4 hover:underline",primary:"text-primary bg-primary",white:"bg-white",dark:"bg-gray-600 text-white backdrop-blur-sm hover:bg-grey-500",purple:"text-white font-medium hover:shadow-md rounded-[10px] bg-gradient-to-br from-[#4C2652] to-[#5C4279] cursor-pointer",purple_light:"text-[#4C2652] hover:bg-[#4C2652]/5 font-medium rounded-[10px] bg-[#4C2652]/10 border border-[#4C2652]/20 cursor-pointer",primary_outline:"text-[#2D2D2D] font-medium hover:bg-[#2D2D2D]/5 rounded-[12px] border border-[#2D2D2D]/20 px-[10px] py-[9px] gap-[8px] opacity-100 font-mono uppercase"},size:{default:"px-7 py-4",sm:"h-8 rounded-md px-3 text-sm",lg:"h-10 rounded-md px-8",icon:"h-9 w-9",round:"rounded-full p-2 aspect-square mr-auto",questionnaire:"px-8 py-3 min-w-[120px]"}},defaultVariants:{variant:"default",size:"default"}}),u=r.forwardRef((e,r)=>{let{className:i,variant:u,size:l,asChild:s=!1,...c}=e,d=s?n.Slot:"button";return(0,t.jsx)(d,{className:(0,o.cn)(a({variant:u,size:l,className:i})),ref:r,...c})});u.displayName="Button"},475254,e=>{"use strict";e.s(["default",()=>o],475254);var t=e.i(271645);let r=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)((e,i)=>{let{color:o="currentColor",size:a=24,strokeWidth:u=2,absoluteStrokeWidth:l,className:s="",children:c,iconNode:d,...f}=e;return(0,t.createElement)("svg",{ref:i,...n,width:a,height:a,stroke:o,strokeWidth:l?24*Number(u)/Number(a):u,className:r("lucide",s),...f},[...d.map(e=>{let[r,n]=e;return(0,t.createElement)(r,n)}),...Array.isArray(c)?c:[c]])}),o=(e,n)=>{let o=(0,t.forwardRef)((o,a)=>{let{className:u,...l}=o;return(0,t.createElement)(i,{ref:a,iconNode:n,className:r("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),u),...l})});return o.displayName="".concat(e),o}},995446,e=>{"use strict";e.s(["useObs",()=>n,"useObsWithError",()=>r]);var t=e.i(271645);let r=function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[i,o]=(0,t.useState)(void 0),[a,u]=(0,t.useState)(null),[l,s]=(0,t.useState)(!0),c=null==r?void 0:r.map(e=>JSON.stringify(e));return(0,t.useEffect)(()=>{n.log&&console.log("useObsWithError: deps changed",r),s(!0);let t=e.subscribe({next:e=>{o(e),u(null),s(!1)},error:e=>{u(e),console.log("error in obs",e,r),s(!1)}});return()=>t.unsubscribe()},c||[]),(0,t.useMemo)(()=>({value:i,error:a,loading:l}),[i,a,l])},n=(e,t)=>{var n;return null==(n=r(e,t))?void 0:n.value}},117595,e=>{"use strict";function t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}e.s(["default",()=>r]);var r=function e(r,n){function i(e,i,o){if("undefined"!=typeof document){"number"==typeof(o=t({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var u in o)o[u]&&(a+="; "+u,!0!==o[u]&&(a+="="+o[u].split(";")[0]));return document.cookie=e+"="+r.write(i,e)+a}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],n={},i=0;i<t.length;i++){var o=t[i].split("="),a=o.slice(1).join("=");try{var u=decodeURIComponent(o[0]);if(n[u]=r.read(a,u),e===u)break}catch(e){}}return e?n[e]:n}},remove:function(e,r){i(e,"",t({},r,{expires:-1}))},withAttributes:function(r){return e(this.converter,t({},this.attributes,r))},withConverter:function(r){return e(t({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(r)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},618566,(e,t,r)=>{t.exports=e.r(976562)},479393,(e,t,r)=>{t.exports=function(e){return void 0===e}},447285,e=>{"use strict";e.s(["isTestDocId",()=>n,"isTestUserId",()=>r,"testIdPrefix",()=>t]);let t="__testId__",r=e=>!!e&&e.startsWith(t),n=e=>!!e&&e.startsWith(t)},748891,(e,t,r)=>{var n=/\s/;t.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},830364,(e,t,r)=>{var n=e.r(748891),i=/^\s+/;t.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},773759,(e,t,r)=>{var n=e.r(830364),i=e.r(12447),o=e.r(361884),a=0/0,u=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;t.exports=function(e){if("number"==typeof e)return e;if(o(e))return a;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=l.test(e);return r||s.test(e)?c(e.slice(2),r?2:8):u.test(e)?a:+e}},631926,(e,t,r)=>{var n=e.r(139088);t.exports=function(){return n.Date.now()}},374009,(e,t,r)=>{var n=e.r(12447),i=e.r(631926),o=e.r(773759),a=Math.max,u=Math.min;t.exports=function(e,t,r){var l,s,c,d,f,p,v=0,m=!1,h=!1,g=!0;if("function"!=typeof e)throw TypeError("Expected a function");function y(t){var r=l,n=s;return l=s=void 0,v=t,d=e.apply(n,r)}function b(e){var r=e-p,n=e-v;return void 0===p||r>=t||r<0||h&&n>=c}function w(){var e,r,n,o=i();if(b(o))return x(o);f=setTimeout(w,(e=o-p,r=o-v,n=t-e,h?u(n,c-r):n))}function x(e){return(f=void 0,g&&l)?y(e):(l=s=void 0,d)}function C(){var e,r=i(),n=b(r);if(l=arguments,s=this,p=r,n){if(void 0===f)return v=e=p,f=setTimeout(w,t),m?y(e):d;if(h)return clearTimeout(f),f=setTimeout(w,t),y(p)}return void 0===f&&(f=setTimeout(w,t)),d}return t=o(t)||0,n(r)&&(m=!!r.leading,c=(h="maxWait"in r)?a(o(r.maxWait)||0,t):c,g="trailing"in r?!!r.trailing:g),C.cancel=function(){void 0!==f&&clearTimeout(f),v=0,l=p=s=f=void 0},C.flush=function(){return void 0===f?d:x(i())},C}},893671,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.timeout=void 0,r.timeout=function(e,t){if("INFINITELY"===e)return t(function(){return!1});var r=!1,n=function(){return r};return new Promise(function(i,o){var a=setTimeout(function(){r=!0,o(Error("Timeout after "+e+"ms"))},e);t(n).then(function(e){i(e),clearTimeout(a)},function(e){o(e),clearTimeout(a)})})}},859196,(e,t,r)=>{"use strict";var n=e.e&&e.e.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=e.e&&e.e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function u(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,u)}l((n=n.apply(e,t||[])).next())})},o=e.e&&e.e.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){var l=[o,u];if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&l[0]?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){a=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(6===l[0]&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}};Object.defineProperty(r,"__esModule",{value:!0}),r.NotRetryableError=r.RetryError=r.notEmpty=r.customizeRetry=r.customizeDecorator=r.retryDecorator=r.retry=r.wait=r.defaultRetryConfig=void 0;var a=e.r(893671),u=function(e,t){return t},l=function(e,t){return e*t},s=function(e,t){return Math.pow(t,e)};function c(e){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,new Promise(function(t){return setTimeout(t,e)})]})})}function d(e,t){return i(this,void 0,void 0,function(){var n;return o(this,function(d){return n=Object.assign({},r.defaultRetryConfig,t),[2,a.timeout(n.timeout,function(t){return function(e,t,r){return i(this,void 0,void 0,function(){var n,i,a,d,f,v,h;return o(this,function(o){switch(o.label){case 0:switch(t.backoff){case"EXPONENTIAL":i=s;break;case"FIXED":i=u;break;case"LINEAR":i=l;break;default:i=t.backoff}a="INFINITELY"===t.retries?Number.MAX_SAFE_INTEGER:t.retries,d=0,o.label=1;case 1:if(!(d<=a))return[3,8];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,e()];case 3:if(f=o.sent(),t.until(f))return[2,f];return t.logger("Until condition not met by "+f),[3,5];case 4:if(v=o.sent(),!t.retryIf(v))throw v;if(v.name===m.name)throw new p("Met not retryable error. Last error: "+v,v);return n=v,t.logger("Retry failed: "+v.message),[3,5];case 5:return[4,c((h=i(d+1,t.delay))>t.maxBackOff?t.maxBackOff:h)];case 6:if(o.sent(),r())return[3,8];o.label=7;case 7:return d++,[3,1];case 8:throw new p("All retries failed. Last error: "+n,n)}})})}(e,n,t)})]})})}function f(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return d(function(){return e.apply(void 0,r)},t)}}r.defaultRetryConfig={backoff:"FIXED",delay:100,logger:function(){},maxBackOff:3e5,retries:10,timeout:6e4,until:function(){return!0},retryIf:function(){return!0}},r.wait=c,r.retry=d,r.retryDecorator=f,r.customizeDecorator=function(e){return function(t,r){return f(t,Object.assign({},e,r))}},r.customizeRetry=function(e){return function(t,r){return d(t,Object.assign({},e,r))}},r.notEmpty=function(e){return Array.isArray(e)?e.length>0:null!=e};var p=function(e){function t(t,r){var n=e.call(this,t)||this;return n.lastError=r,n}return n(t,e),t}(Error);r.RetryError=p;var v=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.message=e,Error.apply(this,t)};v.prototype=Error();var m=function(e){function t(t){var r=e.call(this,t)||this;return Object.defineProperty(r,"name",{value:r.constructor.name}),r}return n(t,e),t}(v);r.NotRetryableError=m},910115,e=>{"use strict";e.s(["isProdCode",()=>t]);let t=!0},224283,(e,t,r)=>{var n=e.r(374009),i=e.r(12447);t.exports=function(e,t,r){var o=!0,a=!0;if("function"!=typeof e)throw TypeError("Expected a function");return i(r)&&(o="leading"in r?!!r.leading:o,a="trailing"in r?!!r.trailing:a),n(e,t,{leading:o,maxWait:t,trailing:a})}},113447,e=>{"use strict";e.s(["InternalRole",()=>t,"UserRole",()=>r]);var t=function(e){return e.internal="internal",e.practitioner="practitioner",e.admin="admin",e.upgradeable="upgradeable",e.adminReadOnly="adminReadOnly",e}({}),r=function(e){return e.Patient="Patient",e.ExternalViewer="ExternalViewer",e}({})},951984,130014,e=>{"use strict";e.s(["UserContext",()=>x,"UserProvider",()=>C,"useUser",()=>E],951984);var t=e.i(843476);e.i(151718);var r=e.i(506973),n=e.i(859196),i=e.i(910115),o=e.i(117595),a=e.i(224283),u=e.i(604570),l=e.i(271645),s=e.i(908083);e.s(["UPGRADE_EXPIRATION_BUFFER_MS",()=>f,"getUpgradedRolesWithEndTimes",()=>p,"hasEffectiveRole",()=>v,"isAbleToSwitchToTestUser",()=>y,"isReadAdminFromClaims",()=>h,"isTestUser",()=>g,"isWriteAdminFromClaims",()=>m],130014);var c=e.i(113447),d=e.i(447285);let f=6e4,p=e=>{let t=Date.now()-f;return Object.entries(e||{}).flatMap(e=>{let[r,n]=e,i=r.split("-")[0];return n&&n>t?{role:i,endTime:n}:[]})},v=(e,t)=>p(e).some(e=>e.role===t)||!!(null==e?void 0:e[t]),m=e=>v(e,c.InternalRole.admin),h=e=>v(e,c.InternalRole.admin)||v(e,c.InternalRole.adminReadOnly),g=e=>(0,d.isTestDocId)(null==e?void 0:e.uid),y=e=>v(e,c.InternalRole.internal)||g(e);var b=e.i(717038),w=e.i(995446);let x=(0,l.createContext)({user:null,loading:!0,loadingClaims:!0,isAuthenticated:!1,userProfile:null,userProfileIsLoading:!0,claims:null,isWriteAdmin:!1,isReadAdmin:!1,isInternal:!1,emailVerified:!1,has2FA:!1,isFullySecured:!1,refresh2faEnrollment:()=>{},refreshClaims:()=>Promise.resolve(),isPractitioner:!1,isUpgradeable:!1,setAuthTokenCookie:()=>Promise.resolve(),isUpgradedTo:[],isTestUser:!1,setUserLoading:()=>{},getRefreshedToken:()=>Promise.resolve(null)}),C=e=>{let{children:g}=e,[y,C]=(0,l.useState)(null),[E,_]=(0,l.useState)(!0),[R,k]=(0,l.useState)(!0),[I,A]=(0,l.useState)(null),[O,T]=(0,l.useState)(!1),[S,N]=(0,l.useState)(!1),P=async()=>{let e=(0,r.getAuth)().currentUser;await (null==e?void 0:e.reload()),e&&N((0,r.multiFactor)(e).enrolledFactors.length>0)},j=(0,l.useCallback)(async()=>{console.error("Token expired and cannot be refreshed. Signing out user.");let e=(0,r.getAuth)((0,s.initFb)().app);A(null),C(null),o.default.remove("__session"),await (0,r.signOut)(e)},[]),U=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t=(0,r.getAuth)((0,s.initFb)().app).currentUser;if(!t)return null;return await t.getIdToken(e)}catch(e){if((null==e?void 0:e.code)==="auth/user-token-expired"||(null==e?void 0:e.code)==="auth/user-disabled"||(null==e?void 0:e.code)==="auth/invalid-user-token")return await j(),null;throw e}},[j]),D=(0,l.useCallback)((0,a.default)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,n.retry)(async()=>{if(!await U(e))throw Error("No user or token expired");let t=(0,r.getAuth)((0,s.initFb)().app);if(!t.currentUser)throw Error("No user");return t.currentUser.getIdTokenResult(e)},{delay:400,retries:3,logger:console.error}).then(e=>{A(e.claims)}).catch(e=>{console.error("Failed to refresh claims:",e)}).finally(()=>{k(!1)})},4e3,{leading:!0}),[U]),F=(0,l.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];C(e),console.log("currentUser",null==e?void 0:e.uid),e?(k(!0),T(e.emailVerified||!1),(0,r.multiFactor)(e).enrolledFactors.length>0||(console.log("would set 2fa to false, even with logged in user",e.uid),u.default.capture("no_2fa_even_with_logged_in_user")),N(!0),await D(),_(!1)):(A(null),k(!1),T(!1),t||_(!1),o.default.remove("__session"))},[D]),W=(0,l.useCallback)((0,a.default)(async()=>{try{let e=await U();console.log("setting auth token cookie"),e?o.default.set("__session",e,{sameSite:"strict",secure:i.isProdCode}):o.default.remove("__session")}catch(e){console.error("Failed to set auth token cookie:",e)}},4e3,{leading:!0}),[U]);(0,l.useEffect)(()=>{let e=(0,s.init)(),t=(0,r.getAuth)(e.app);F(t.currentUser,!0);let n=(0,r.onAuthStateChanged)(t,F);return()=>{n()}},[F,W]);let[,L]=(0,l.useState)(0),M=(0,w.useObs)((0,b.docObs)("userProfile",null==y?void 0:y.uid),[null==y?void 0:y.uid]),B=O&&S,V=m(I),z=v(I,c.InternalRole.internal),X=v(I,c.InternalRole.practitioner),$=v(I,c.InternalRole.upgradeable),Y=h(I),G=p(I),H=(0,d.isTestUserId)(null==y?void 0:y.uid);(0,l.useEffect)(()=>{if(!y||0===G.length)return;let e=setInterval(()=>{let t=Date.now()-f;G.some(e=>e.endTime<=t)&&(clearInterval(e),L(e=>e+1))},6e4);return()=>clearInterval(e)},[y,G]);let q=(0,l.useCallback)(e=>{_(e)},[]);return(0,t.jsx)(x.Provider,{value:{user:y,loading:E,loadingClaims:R,isAuthenticated:!E&&!!y&&!y.isAnonymous,userProfile:M?{...M,email:(null==y?void 0:y.email)||""}:null,userProfileIsLoading:!M,claims:I,isWriteAdmin:V,isReadAdmin:Y,isInternal:z,emailVerified:O,has2FA:S,isFullySecured:B,refresh2faEnrollment:P,refreshClaims:D,isPractitioner:X,isUpgradeable:$,setAuthTokenCookie:W,isUpgradedTo:G,isTestUser:H,setUserLoading:q,getRefreshedToken:U},children:g})},E=()=>(0,l.useContext)(x)},959411,e=>{"use strict";e.s(["Root",()=>a,"VISUALLY_HIDDEN_STYLES",()=>i,"VisuallyHidden",()=>o]);var t=e.i(271645),r=e.i(248425),n=e.i(843476),i=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),o=t.forwardRef((e,t)=>(0,n.jsx)(r.Primitive.span,{...e,ref:t,style:{...i,...e.style}}));o.displayName="VisuallyHidden";var a=o}]);

//# sourceMappingURL=dca33816a595d8bf.js.map
//# debugId=3caa4074-8289-5b80-83d6-6b5e5232a068
