
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="30c0cf50-4ca8-534e-ba34-fd24a1a22b39")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,781947,e=>{"use strict";e.s(["Alert",()=>l,"AlertDescription",()=>o,"AlertTitle",()=>s]);var t=e.i(843476),r=e.i(271645),a=e.i(225913),i=e.i(647163);let n=(0,a.cva)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=r.forwardRef((e,r)=>{let{className:a,variant:l,...s}=e;return(0,t.jsx)("div",{ref:r,role:"alert",className:(0,i.cn)(n({variant:l}),a),...s})});l.displayName="Alert";let s=r.forwardRef((e,r)=>{let{className:a,...n}=e;return(0,t.jsx)("h5",{ref:r,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...n})});s.displayName="AlertTitle";let o=r.forwardRef((e,r)=>{let{className:a,...n}=e;return(0,t.jsx)("div",{ref:r,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...n})});o.displayName="AlertDescription"},184762,e=>{"use strict";e.s(["Textarea",()=>i]);var t=e.i(843476),r=e.i(271645),a=e.i(647163);let i=r.forwardRef((e,r)=>{let{className:i,...n}=e;return(0,t.jsx)("textarea",{className:(0,a.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-xs placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:r,...n})});i.displayName="Textarea"},10708,e=>{"use strict";e.s(["Label",()=>o],10708);var t=e.i(843476),r=e.i(271645),a=e.i(248425),i=r.forwardRef((e,r)=>(0,t.jsx)(a.Primitive.label,{...e,ref:r,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var n=e.i(225913),l=e.i(647163);let s=(0,n.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,r)=>{let{className:a,...n}=e;return(0,t.jsx)(i,{ref:r,className:(0,l.cn)(s(),a),...n})});o.displayName=i.displayName},586318,e=>{"use strict";e.s(["useDirection",()=>a]);var t=e.i(271645);e.i(843476);var r=t.createContext(void 0);function a(e){let a=t.useContext(r);return e||a||"ltr"}},631171,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(475254).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},470152,e=>{"use strict";function t(e,t){let[r,a]=t;return Math.min(a,Math.max(r,e))}e.s(["clamp",()=>t])},999682,e=>{"use strict";e.s(["usePrevious",()=>r]);var t=e.i(271645);function r(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}},63209,e=>{"use strict";e.s(["AlertCircle",()=>t],63209);let t=(0,e.i(475254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},412780,e=>{"use strict";e.s(["addRedirectToPath",()=>i]);var t=e.i(766255),r=e.i(589282),a=e.i(736749);let i=e=>{let i=(0,a.isServerside)()?"":window.location.pathname;return(0,r.addParamsToLink)(e,{[t.redirectParamName]:i})}},878894,e=>{"use strict";e.s(["AlertTriangle",()=>t],878894);let t=(0,e.i(475254).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},996264,373884,405962,e=>{"use strict";e.s(["AdminPageErrorOverlay",()=>C],996264);var t=e.i(843476),r=e.i(412780),a=e.i(618566);e.s(["ErrorOverlay",()=>f],405962);var i=e.i(63209),n=e.i(878894),l=e.i(952571);e.s(["XCircle",()=>s],373884);let s=(0,e.i(475254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var o=e.i(225913),c=e.i(647163),d=e.i(781947);let u=(0,o.cva)("fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-xs transition-opacity",{variants:{level:{info:"",warning:"",error:"",critical:""}},defaultVariants:{level:"error"}}),p=(0,o.cva)("max-w-md mx-auto",{variants:{level:{info:"border-blue-500",warning:"border-yellow-500",error:"border-destructive",critical:"border-red-700 border-2"}},defaultVariants:{level:"error"}}),f=e=>{let{children:r,title:a,level:o="error",visible:f=!0,onClose:v,className:h,...m}=e;if(!f)return null;let g={info:l.Info,warning:n.AlertTriangle,error:i.AlertCircle,critical:s}[o];return(0,t.jsx)("div",{className:(0,c.cn)(u({level:o}),h),onClick:v,...m,children:(0,t.jsxs)(d.Alert,{className:(0,c.cn)(p({level:o})),onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 pb-2",children:[(0,t.jsx)(g,{className:"h-5 w-5"}),(0,t.jsx)(d.AlertTitle,{children:a||function(e){switch(e){case"info":return"Information";case"warning":return"Warning";case"error":default:return"Error";case"critical":return"Critical Error"}}(o)})]}),(0,t.jsx)(d.AlertDescription,{children:r})]})})};var v=e.i(167881),h=e.i(908083);e.i(151718);var m=e.i(506973),g=e.i(951984),y=e.i(271645),b=e.i(10708),x=e.i(62870),w=e.i(184762),O=e.i(113447);let S=r=>{let{onSuccess:a,onCancel:i}=r,n=(0,g.useUser)(),[l,s]=(0,y.useState)(""),[o,c]=(0,y.useState)(600),[d,u]=(0,y.useState)(!1),[p,f]=(0,y.useState)(null),[h,m]=(0,y.useState)("readOnly"),S=async()=>{u(!0),f(null);let t={clinical:[O.InternalRole.admin,O.InternalRole.practitioner],technical:[O.InternalRole.admin],readOnly:[O.InternalRole.adminReadOnly,O.InternalRole.practitioner]}[h],{apiPost:r}=await e.A(914676),i=await r("/api/admin/upgrade",{reason:l,timeBoundSeconds:o,upgradingToRoles:t});if(!i.ok){f(i.error||"Failed to upgrade"),u(!1);return}await n.refreshClaims(!0),f("Upgraded. Claims refreshed."),u(!1),null==a||a(),window.location.reload()};return(0,t.jsxs)("div",{className:"w-full space-y-4",children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:"Temporary Admin Upgrade"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(b.Label,{children:"Reason"}),(0,t.jsx)(w.Textarea,{value:l,onChange:e=>s(e.target.value),placeholder:"Why do you need temporary access?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(b.Label,{children:"Role"}),(0,t.jsxs)(x.Select,{value:h,onValueChange:e=>m(e),children:[(0,t.jsx)(x.SelectTrigger,{className:"w-full",children:(0,t.jsx)(x.SelectValue,{placeholder:"Select role"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{value:"readOnly",children:"Read Only"}),(0,t.jsx)(x.SelectItem,{value:"clinical",children:"Clinical"}),(0,t.jsx)(x.SelectItem,{value:"technical",children:"Technical"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(b.Label,{children:"Duration"}),(0,t.jsxs)(x.Select,{value:String(o),onValueChange:e=>c(parseInt(e,10)),children:[(0,t.jsx)(x.SelectTrigger,{className:"w-full",children:(0,t.jsx)(x.SelectValue,{placeholder:"Select duration"})}),(0,t.jsxs)(x.SelectContent,{children:[(0,t.jsx)(x.SelectItem,{value:String(600),children:"10 minutes"}),(0,t.jsx)(x.SelectItem,{value:String(3600),children:"1 hour"}),(0,t.jsx)(x.SelectItem,{value:String(21600),children:"6 hours"})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(v.Button,{disabled:d||l.trim().length<5,onClick:S,children:d?"Upgrading...":"Upgrade"}),i&&(0,t.jsx)(v.Button,{variant:"outline",onClick:i,children:"Cancel"})]}),p&&(0,t.jsx)("div",{className:"text-sm text-gray-600",children:p})]})},C=e=>{let{isLoggedIn:i}=e,{user:n,claims:l,isWriteAdmin:s,isUpgradeable:o}=(0,g.useUser)(),c=(0,a.useRouter)(),[d,u]=(0,y.useState)(!1);return(0,y.useEffect)(()=>{console.log("showing the admin page error overlay for user",null==n?void 0:n.email,null==n?void 0:n.uid,l,s)},[n,l,s]),(0,t.jsx)(f,{className:"z-[20]",children:(0,t.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,t.jsx)("div",{children:"You are not authorized to view this page."}),(null==n?void 0:n.email)?(0,t.jsxs)("div",{children:["You are logged in as ",null==n?void 0:n.email]}):(0,t.jsx)("div",{children:"You are not logged in"}),!d&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[i?(0,t.jsx)(v.Button,{variant:"default",className:"self-end",size:"sm",onClick:()=>{(0,m.signOut)((0,m.getAuth)((0,h.initFb)().app))},children:"Sign in with a different account"}):(0,t.jsx)(v.Button,{variant:"default",className:"self-end",onClick:()=>c.push((0,r.addRedirectToPath)("/sign_in")),children:"Login"}),o&&(0,t.jsx)(v.Button,{variant:"default",className:"self-end",size:"sm",onClick:()=>u(!0),children:"Upgrade to a new role"})]}),d&&(0,t.jsx)("div",{className:"mt-4 w-full max-w-md",children:(0,t.jsx)(S,{onSuccess:()=>{u(!1)},onCancel:()=>u(!1)})})]})})}},361277,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(475254).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},641015,(e,t,r)=>{var a=e.r(361884);t.exports=function(e,t,r){for(var i=-1,n=e.length;++i<n;){var l=e[i],s=t(l);if(null!=s&&(void 0===o?s==s&&!a(s):r(s,o)))var o=s,c=l}return c}},580957,(e,t,r)=>{t.exports=function(e,t){return e>t}},419530,(e,t,r)=>{var a=e.r(641015),i=e.r(580957),n=e.r(666305);t.exports=function(e,t){return e&&e.length?a(e,n(t,2),i):void 0}},95482,e=>{"use strict";e.s(["ErrorBoundary",()=>i]);var t=e.i(843476),r=e.i(271645),a=e.i(662537);class i extends r.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){var r,i;console.error("ErrorBoundary caught an error:",e,t),a.captureException(e,{contexts:{react:{componentStack:t.componentStack}}}),null==(r=(i=this.props).onError)||r.call(i,e,t)}render(){if(this.state.hasError){var e;return this.props.fallback?this.props.fallback:(0,t.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-black p-4",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"mb-2 text-lg font-semibold",children:"Something went wrong"}),(0,t.jsx)("div",{className:"text-sm opacity-70",children:(null==(e=this.state.error)?void 0:e.message)||"An unexpected error occurred"})]})})}return this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}}},650009,e=>{e.v("/_next/static/media/info_icon.33ce6b92.svg")},460793,(e,t,r)=>{var a=e.r(674548),i=e.r(163799),n=e.r(666305);t.exports=function(e,t){var r={};return t=n(t,3),i(e,function(e,i,n){a(r,i,t(e,i,n))}),r}},972745,(e,t,r)=>{t.exports=function(e){if("function"!=typeof e)throw TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},181829,(e,t,r)=>{var a=e.r(333141),i=e.r(942173),n=e.r(186287);t.exports=function(e,t,r){for(var l=-1,s=t.length,o={};++l<s;){var c=t[l],d=a(e,c);r(d,c)&&i(o,n(c,e),d)}return o}},584262,(e,t,r)=>{var a=e.r(892708),i=e.r(666305),n=e.r(181829),l=e.r(807889);t.exports=function(e,t){if(null==e)return{};var r=a(l(e),function(e){return[e]});return t=i(t),n(e,r,function(e,r){return t(e,r[0])})}},468212,(e,t,r)=>{var a=e.r(666305),i=e.r(972745),n=e.r(584262);t.exports=function(e,t){return n(e,i(a(t)))}},764085,e=>{"use strict";e.s(["filterDataPoints",()=>A,"getEmptyReportObservables",()=>T,"getReportDateWithoutDatapoints",()=>D,"getReportObservables",()=>N,"processReportData",()=>P],764085);var t=e.i(165981),r=e.i(395361),a=e.i(355145),i=e.i(665512),n=e.i(387888),l=e.i(987749);e.i(943545),e.i(130014);var s=e.i(717038),o=function(e){return e.CH="CH",e}({}),c=e.i(159556),d=e.i(787935),u=e.i(137921),p=e.i(26177),f=e.i(735321),v=e.i(197032),h=e.i(392294),m=e.i(945919),g=e.i(946217),y=e.i(629873),b=e.i(460793),x=e.i(419530),w=e.i(691027),O=e.i(468212),S=e.i(909817),C=e.i(245281),j=e.i(94059),k=e.i(827341),R=e.i(134352);let D=e=>e.dataCollectionDate||e.releasedOn||e.createdAt,I=(e,t,r)=>({forReport:e.filter(e=>{var t;return null==(t=e.reportKeys)?void 0:t.includes(r||"__NEVER__")}),forUser:e.filter(e=>e.userKey===t)}),N=(e,t,r)=>{let a=(0,s.docObs)("report",e).pipe((0,k.shareReplay)(1)),p=a.pipe((0,R.switchMap)(e=>{var a;let i=(null==e||null==(a=e.visibleTo)?void 0:a.includes("public"))?"public":null,n=null==e?void 0:e.patientKey,s=(0,S.default)((0,l.filterBool)([i,r?n:t]));return(0,C.of)(s.length>0?s:null)}),(0,k.shareReplay)({bufferSize:1,refCount:!0})),f=p.pipe((0,R.switchMap)(t=>t?(0,s.queryObs)("dataPoint",e=>{let{where:r}=e;return[r("visibleTo","array-contains-any",t)]}).pipe((0,j.map)(t=>((e,t)=>{let r=new Map;return e.forEach(e=>{let t=(e=>{var t,r,a;let i=(null==(t=e.dataPoint.biomarkerData)?void 0:t.biomarkerId)||(0,n.getUuid)(),l=(null==(r=e.dataPoint.collectedOnDate)?void 0:r.toDate())||(null==(a=e.createdAt)?void 0:a.toDate())||Date.now(),s=(0,m.formatDate)(l,"yyyy-MM-dd");return"".concat(i,"-").concat(s)})(e);r.has(t)||r.set(t,[]),r.get(t).push(e)}),Array.from(r.values()).map(e=>t&&1!==e.length&&e.find(e=>{var r;return null==(r=e.reportKeys)?void 0:r.includes(t)})||e[0])})(t,e))):(0,C.of)([])),(0,k.shareReplay)({bufferSize:1,refCount:!0})),v=a.pipe((0,R.switchMap)(e=>(null==e?void 0:e.fromBookingKey)?(0,s.docObs)("booking",e.fromBookingKey):(0,C.of)(null))),h=f.pipe((0,R.switchMap)(t=>0===t.length?(0,C.of)([]):(0,i.getBulkDataPointsWithHydratedInfoObs)(t,e))),g=p.pipe((0,R.switchMap)(t=>t?(0,s.queryObs)("sourceFile",a=>{let{where:i}=a;return[i("downloadableStatus","in",[c.SourceFileDownloadableStatus.MRI_SOURCE,c.SourceFileDownloadableStatus.LAB_SOURCE,c.SourceFileDownloadableStatus.CT_SOURCE,c.SourceFileDownloadableStatus.CUSTOM_SOURCE]),r?i("reportKeys","array-contains",e):i("visibleTo","array-contains-any",t)]}):(0,C.of)([]))),y=p.pipe((0,R.switchMap)(e=>e?(0,s.queryObs)("report",t=>{let{where:r}=t;return[r("visibleTo","array-contains-any",e)]}):(0,C.of)([])),(0,k.shareReplay)({bufferSize:1,refCount:!0})),b=a.pipe((0,R.switchMap)(e=>(null==e?void 0:e.doctorKey)?(0,s.docObs)("doctorProfile",e.doctorKey):(0,C.of)(void 0))),x=p.pipe((0,R.switchMap)(t=>(0,s.queryObs)("healthNote",a=>{let{where:i}=a;return[i("reportKey","==",e),r?null:i("visibleTo","array-contains-any",t)]},{includeArchived:!0}))),w=(0,d.getObsForPanelInfo)(),O=(0,u.getObsForOrganSystemData)(),D=p.pipe((0,R.switchMap)(e=>(0,s.queryObs)("healthOptimisation",t=>{let{where:a}=t;return[a("isMatch","==",!0),r?null:a("review.approved","==",!0),a("visibleTo","array-contains-any",e)]}))),I=p.pipe((0,R.switchMap)(e=>(0,s.queryObs)("clinicalFollowup",t=>{let{where:a}=t;return[a("isMatch","==",!0),r?null:a("review.approved","==",!0),a("visibleTo","array-contains-any",e)]}))),N=(0,s.queryObs)("healthOptimisationType"),T=(0,s.queryObs)("clinicalFollowupType"),A=(0,s.queryObs)("availableArticle"),P=(0,s.queryObs)("referralGuide").pipe((0,j.map)(e=>e.find(e=>e.country.includes(o.CH))||null)),M=(0,s.queryObs)("clinics"),E=(0,s.queryObs)("products");return{reportObs:a,hydratedDataPointsObs:h,sourceFilesObs:g,doctorObs:b,notesObs:x,panelsObs:w,organsObs:O,optimisationsObs:D,followupsObs:I,optimisationTypesObs:N,followupTypesObs:T,availableArticlesObs:A,referralGuidesObs:P,bookingObs:v,clinicsObs:M,productsObs:E,preparationInstructionsObs:(0,s.queryObs)("preparationInstruction"),questionnaireResponsesObs:p.pipe((0,R.switchMap)(e=>e?(0,s.queryObs)("questionnaireResponses",t=>{let{where:r,orderBy:a}=t;return[r("visibleTo","array-contains-any",e),a("requestedAt","desc")]}):(0,C.of)([]))),userReportsObs:y}},T=e=>({reportObs:(0,C.of)({uid:e}),hydratedDataPointsObs:(0,C.of)([]),sourceFilesObs:(0,C.of)([]),doctorObs:(0,C.of)(null),notesObs:(0,C.of)([]),panelsObs:(0,C.of)({}),organsObs:(0,C.of)({}),optimisationsObs:(0,C.of)([]),followupsObs:(0,C.of)([]),optimisationTypesObs:(0,C.of)([]),followupTypesObs:(0,C.of)([]),availableArticlesObs:(0,C.of)([]),referralGuidesObs:(0,C.of)(null),bookingObs:(0,C.of)(null),clinicsObs:(0,C.of)([]),productsObs:(0,C.of)([]),preparationInstructionsObs:(0,C.of)([]),questionnaireResponsesObs:(0,C.of)([]),userReportsObs:(0,C.of)([])}),A=(e,r)=>{if("all"===r);else if("out-of-range"===r)return e.filter(e=>(0,f.getDpRangeState)(e).overallIndication===t.OutOfRangeIndication.Bad||(0,f.getDpRangeState)(e).overallIndication===t.OutOfRangeIndication.Intermediate);else if("radiology-only"===r)return e.filter(e=>(0,h.isImageBasedTextFindingDp)(e));return e},P=(e,t)=>{var i,n,l;let{report:s,dataPoints:o,sourceFiles:c,notes:d,panels:u,organs:f,reportKey:h,userKey:m,filter:S,isAdmin:C,optimisations:j,followups:k,optimisationTypes:R,followupTypes:D,referralGuide:N,products:T,clinics:P,preparationInstructions:M,questionnaireResponses:E}=e,F=o.map(e=>{let r=e.info?(0,p.translateFieldsInStaticData)("biomarkerInfo",e.info,t):null;return{...e,info:r}}),q=u.map(e=>(0,p.translateFieldsInStaticData)("biomarkerPanelInfo",e,t)).filter(e=>{var t,r;return!e.gender||null==(t=s.patientData)||!t.gender||e.gender===(null==(r=s.patientData)?void 0:r.gender)}),B=(0,b.default)(f,e=>(0,p.translateFieldsInStaticData)("organSystemInfo",e,t)),_=N?(0,p.translateFieldsInStaticData)("referralGuide",N,t):null,K=R.map(e=>(0,p.translateFieldsInStaticData)("healthOptimisationType",e,t,v.NS.HEALTH_ACTIONS)),U=D.map(e=>(0,p.translateFieldsInStaticData)("clinicalFollowupType",e,t,v.NS.HEALTH_ACTIONS)),L=T.map(e=>(0,p.translateFieldsInStaticData)("products",e,t,v.NS.BOOKING)),z=P.map(e=>(0,p.translateFieldsInStaticData)("clinics",e,t,v.NS.BOOKING)),H=M.map(e=>(0,p.translateFieldsInStaticData)("preparationInstruction",e,t,v.NS.STATIC_DATA)),{forReport:G,forUser:V}=I(F,s.patientKey,h),W=G.filter(e=>(0,r.dpIsActive)(e)),Y=(0,a.groupDataPoints)(A(W,S),q,Object.values(B),null==(i=s.patientData)?void 0:i.gender),X=(0,w.default)(Y,a.NOT_TAGGED_GROUP_KEY),J=(0,O.default)(X,e=>(0,g.default)((0,w.default)(e.panels,a.NO_PANEL_GROUP_KEY))),Q=d.filter(e=>{var t;return(null==(t=e.approval)?void 0:t.approvedAt)||C}),Z=((e,t)=>(0,b.default)(t,t=>{let r=null==e?void 0:e.filter(e=>{var r;return(null==(r=e.tags)?void 0:r.organ)===t.organId}),a=null==r?void 0:r.find(e=>{var t,r;return(0,y.default)(null==(t=e.tags)?void 0:t.panelId)&&(0,y.default)(null==(r=e.tags)?void 0:r.source)});return{...t,note:a}}))(Q,J),$=I(c,m,h).forReport,ee=d.find(e=>{var t;return null==(t=e.tags)?void 0:t.isReportSummary}),et=d.find(e=>{var t;return null==(t=e.tags)?void 0:t.isActionSummary}),er=(null==et||null==(n=et.approval)?void 0:n.approvedAt)||C?et:null,ea=((e,t)=>{var r;let a=e.filter(e=>!!e.dataPoint.collectedOnDate);return t.dataCollectionDate||(null==(r=(0,x.default)(a,e=>e.dataPoint.collectedOnDate))?void 0:r.dataPoint.collectedOnDate)||t.releasedOn||t.createdAt})(W,s),ei=j.map(e=>({...e,type:K.find(t=>t.typeId===e.type)})),en=k.map(e=>({...e,type:U.find(t=>t.typeId===e.type)}));return{report:s,dataPointsForThisReport:{grouped:Z,all:W},sourceFiles:$,reportSummary:(null==ee||null==(l=ee.approval)?void 0:l.approvedAt)||C?ee:null,allHealthNotes:Q,allDataPoints:V,effectiveReportDate:(null==ea?void 0:ea.toDate())||null,getOrganInfo:e=>Object.values(f).find(t=>t.organId===e),optimisationsForCurrentReport:ei.filter(e=>e.reportKey===h),followupsForCurrentReport:en.filter(e=>e.reportKey===h),allOptimisations:ei,allFollowups:en,actionSummary:er,getFollowupById:e=>en.find(t=>t.uid===e),getOptimisationById:e=>ei.find(t=>t.uid===e),referralGuide:_,panelsInReport:q,clinics:z,products:L,questionnaireResponses:E,preparationInstructions:H}}},111369,687607,e=>{"use strict";e.s(["Collapsible",()=>k,"CollapsibleContent",()=>D,"CollapsibleTrigger",()=>R],111369),e.s(["CollapsibleContent",()=>x,"CollapsibleTrigger",()=>y,"Content",()=>j,"Root",()=>S,"Trigger",()=>C,"createCollapsibleScope",()=>f],687607);var t=e.i(271645),r=e.i(981140),a=e.i(30030),i=e.i(369340),n=e.i(934620),l=e.i(820783),s=e.i(248425),o=e.i(296626),c=e.i(610772),d=e.i(843476),u="Collapsible",[p,f]=(0,a.createContextScope)(u),[v,h]=p(u),m=t.forwardRef((e,r)=>{let{__scopeCollapsible:a,open:n,defaultOpen:l,disabled:o,onOpenChange:p,...f}=e,[h,m]=(0,i.useControllableState)({prop:n,defaultProp:null!=l&&l,onChange:p,caller:u});return(0,d.jsx)(v,{scope:a,disabled:o,contentId:(0,c.useId)(),open:h,onOpenToggle:t.useCallback(()=>m(e=>!e),[m]),children:(0,d.jsx)(s.Primitive.div,{"data-state":O(h),"data-disabled":o?"":void 0,...f,ref:r})})});m.displayName=u;var g="CollapsibleTrigger",y=t.forwardRef((e,t)=>{let{__scopeCollapsible:a,...i}=e,n=h(g,a);return(0,d.jsx)(s.Primitive.button,{type:"button","aria-controls":n.contentId,"aria-expanded":n.open||!1,"data-state":O(n.open),"data-disabled":n.disabled?"":void 0,disabled:n.disabled,...i,ref:t,onClick:(0,r.composeEventHandlers)(e.onClick,n.onOpenToggle)})});y.displayName=g;var b="CollapsibleContent",x=t.forwardRef((e,t)=>{let{forceMount:r,...a}=e,i=h(b,e.__scopeCollapsible);return(0,d.jsx)(o.Presence,{present:r||i.open,children:e=>{let{present:r}=e;return(0,d.jsx)(w,{...a,ref:t,present:r})}})});x.displayName=b;var w=t.forwardRef((e,r)=>{let{__scopeCollapsible:a,present:i,children:o,...c}=e,u=h(b,a),[p,f]=t.useState(i),v=t.useRef(null),m=(0,l.useComposedRefs)(r,v),g=t.useRef(0),y=g.current,x=t.useRef(0),w=x.current,S=u.open||p,C=t.useRef(S),j=t.useRef(void 0);return t.useEffect(()=>{let e=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,n.useLayoutEffect)(()=>{let e=v.current;if(e){j.current=j.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";let t=e.getBoundingClientRect();g.current=t.height,x.current=t.width,C.current||(e.style.transitionDuration=j.current.transitionDuration,e.style.animationName=j.current.animationName),f(i)}},[u.open,i]),(0,d.jsx)(s.Primitive.div,{"data-state":O(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!S,...c,ref:m,style:{"--radix-collapsible-content-height":y?"".concat(y,"px"):void 0,"--radix-collapsible-content-width":w?"".concat(w,"px"):void 0,...e.style},children:S&&o})});function O(e){return e?"open":"closed"}var S=m,C=y,j=x;let k=S,R=y,D=x},39751,e=>{"use strict";e.s(["sortHealthActions",()=>r]);var t=e.i(831195);let r=e=>(0,t.default)(e,[e=>{var t;return(null==(t=e.dueDateTimestamp)?void 0:t.toMillis())||null},e=>{var t;let r=null==(t=e.triggeringDataPointKeys)?void 0:t[0];return null==e.index?r:null},e=>null==e.index?-1:e.index])},503116,e=>{"use strict";e.s(["Clock",()=>t],503116);let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},87316,e=>{"use strict";e.s(["Calendar",()=>t.default]);var t=e.i(361277)},778917,e=>{"use strict";e.s(["ExternalLink",()=>t],778917);let t=(0,e.i(475254).default)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},617852,e=>{"use strict";e.s(["objKeys",()=>t]);let t=Object.keys;Object.keys},16715,e=>{"use strict";e.s(["RefreshCw",()=>t],16715);let t=(0,e.i(475254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},994179,e=>{"use strict";e.s(["Badge",()=>n]);var t=e.i(843476),r=e.i(225913),a=e.i(647163);let i=(0,r.cva)("inline-flex items-center justify-center rounded-[40px] px-[8px] pt-[2px] pb-[1px] text-xs font-medium",{variants:{variant:{default:"border-transparent bg-white text-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-white hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-white shadow hover:bg-destructive/80",warning:"border-transparent bg-warning text-white shadow hover:bg-warning/80",success:"border-transparent bg-success text-white shadow hover:bg-success/80",outline:"text-foreground",required:"bg-gradient-to-r from-rust-200 to-rust-300 text-rust-900 border-transparent",inProgress:"gradient-light-blue text-blue-900 border-transparent",complete:"bg-gradient-to-r from-deep-green-300 to-deep-green-400 text-deep-green-900 border-transparent",action:"border border-zinc-800/10 bg-transparent text-zinc-800"}},defaultVariants:{variant:"default"}});function n(e){let{className:r,variant:n,...l}=e;return(0,t.jsx)("div",{className:(0,a.cn)(i({variant:n}),r),...l})}},107233,e=>{"use strict";e.s(["Plus",()=>t],107233);let t=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},346897,e=>{"use strict";e.s(["MapPin",()=>t],346897);let t=(0,e.i(475254).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},242100,e=>{e.v(t=>Promise.all(["static/chunks/12cf6f3cad014535.js","static/chunks/9615b62552c98e11.js","static/chunks/c54a6ecfa00e8874.js"].map(t=>e.l(t))).then(()=>t(938179)))},402754,e=>{e.v(t=>Promise.all(["static/chunks/eea5e9bc5ef88122.js","static/chunks/58b0ac7d82a27320.js","static/chunks/f7f1b11153d79420.js"].map(t=>e.l(t))).then(()=>t(156040)))},914676,e=>{e.v(e=>Promise.resolve().then(()=>e(427322)))}]);

//# sourceMappingURL=de10a74d4989860d.js.map
//# debugId=30c0cf50-4ca8-534e-ba34-fd24a1a22b39
